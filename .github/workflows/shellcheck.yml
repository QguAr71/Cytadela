name: ShellCheck

on:
  push:
  pull_request:

jobs:
  shellcheck:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install ShellCheck
        run: sudo apt-get update && sudo apt-get install -y shellcheck

      - name: Run ShellCheck
        run: |
          # Check main scripts (v3.1.0)
          shellcheck -S warning -e SC2034 citadel.sh
          shellcheck -S warning -e SC2034 citadel_en.sh
          
          # Check core libraries
          shellcheck -S warning -e SC2034 lib/*.sh
          
          # Check modules (allow unused variables for module exports)
          shellcheck -S warning -e SC2034 modules/*.sh
          
          # Check legacy scripts (optional, allow failures)
          shellcheck -S warning legacy/cytadela++.sh || true
          shellcheck -S warning legacy/citadela_en.sh || true
