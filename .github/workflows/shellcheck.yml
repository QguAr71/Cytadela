name: ShellCheck

on:
  push:
  pull_request:

jobs:
  shellcheck:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install ShellCheck
        run: sudo apt-get update && sudo apt-get install -y shellcheck

      - name: Run ShellCheck
        run: |
          # Check legacy monolithic scripts
          shellcheck -S warning cytadela++.sh || true
          shellcheck -S warning citadela_en.sh || true
          
          # Check new modular wrappers (v3.1.0)
          shellcheck -S warning -e SC2034 cytadela++.new.sh
          shellcheck -S warning -e SC2034 citadela_en.new.sh
          
          # Check core libraries
          shellcheck -S warning -e SC2034 lib/*.sh
          
          # Check modules (allow unused variables for module exports)
          shellcheck -S warning -e SC2034 modules/*.sh
